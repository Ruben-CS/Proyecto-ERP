@page "/inicio/overview"
@using global::Services.Gestion
@using SortDirection = MudBlazor.SortDirection
@inject GestionServices GestionServices
@layout DashboardLayout

@* Table goes here *@
<h3>Lista de gestiones activas</h3>
<MudTable Items="_gestiones.Take(2)" Hover="true" Breakpoint="Breakpoint.Sm" Striped="true" Bordered="true" Elevation="1">
    <HeaderContent>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<GestionDto, object>(x => x.Nombre)">
                Nombre
            </MudTableSortLabel>
        </MudTh>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<GestionDto, object>(x => x.FechaInicio)" InitialDirection="SortDirection.Ascending">
                Inicio de la gestion
            </MudTableSortLabel>
        </MudTh>
        <MudTh>
            <MudTableSortLabel SortBy="new Func<GestionDto, object>(x => x.FechaFin)">
                Fin de la gestion
            </MudTableSortLabel>
        </MudTh>
        <MudTh>
            <MudTableSortLabel InitialDirection="SortDirection.Ascending" SortBy="new Func<GestionDto, object>(x => x.Estado)">
                Estado actual
            </MudTableSortLabel>
        </MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Nombre">@context.Nombre</MudTd>
        <MudTd DataLabel="Fecha Inicio">@context.FechaInicio.ToShortDateString()</MudTd>
        <MudTd DataLabel="Fecha Fin">@context.FechaFin.ToShortDateString()</MudTd>
        <MudTd DataLabel="Estado">@context.Estado</MudTd>
    </RowTemplate>
</MudTable>

@code {
    private IEnumerable<GestionDto> _gestiones = new List<GestionDto>();

    protected override async Task OnInitializedAsync()
    {
        _gestiones = await GestionServices.GetGestionAsync();
    }

}