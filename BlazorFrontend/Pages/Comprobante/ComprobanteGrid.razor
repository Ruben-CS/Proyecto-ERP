@page "/comprobantegrid/{idempresa:int}"
@using global::Services.EmpresaMonedaService
@using global::Services.Moneda
@using global::Services.Comprobante
@using Modelos.Models.Enums
@inject EmpresaMonedaService EmpresaMonedaService
@inject MonedaService MonedaService
@layout ComprobanteLayout
@inject IDialogService DialogService
@inject ComprobanteService ComprobanteService
@inject HttpClient HttpClient
@inject ISnackbar Snackbar


<NavBarComponent IdEmpresa="@IdEmpresa"/>

<MudGrid Spacing="3" Justify="Justify.Center" Style="box-shadow: black">
    <MudItem xs="12" sm="4">
        <MudTextField Variant="Variant.Outlined"
                      Label="Serie"
                      T="string"
                      @bind-Value="SerieString"
                      Disabled="true"/>
    </MudItem>
    <MudItem xs="12" sm="4">
        <MudDatePicker Variant="Variant.Outlined"
                       Label="Fecha"
                       @bind-Date="@Fecha"/>
    </MudItem>
    <MudItem xs="12" sm="4">
        <MudSelect Variant="Variant.Outlined"
                   Label="Tipo de comprobante"
                   @bind-Value="SelectedTipoComprobante"
                   T="string">
            @foreach (var type in ComprobanteTypes)
            {
                <MudSelectItem Value="@type">@type</MudSelectItem>
            }
        </MudSelect>

    </MudItem>
    <MudItem xs="12" sm="4">
        <MudTextField @bind-Value="@TipoDeCambioString"
                      Label="Tipo de cambio"
                      Class="right-aligned-input"
                      Variant="Variant.Outlined"/>
    </MudItem>
    <MudItem xs="12" sm="4">
        <MudSelect Variant="Variant.Outlined"
                   Label="Moneda"
                   @bind-Value="SelectedEmpresaMoneda"
                   T="string">
            @foreach (var moneda in MonedasDeLaEmpresa)
            {
                <MudSelectItem Value="@moneda.Nombre">
                    @moneda.Nombre
                </MudSelectItem>
            }
        </MudSelect>
    </MudItem>
    <MudItem xs="12" sm="4">
        <MudSelect Variant="Variant.Outlined"
                   Label="Estado"
                   T="string"
                   Disabled="true"
                   bind-Text="@EstadoComprobante.Abierto.ToString()"
                   Placeholder="@EstadoComprobante.Abierto.ToString()">
        </MudSelect>
    </MudItem>
    <MudItem xs="12">
        <MudTextField Variant="Variant.Outlined"
                      Label="Glosa"
                      T="string"
                      @bind-Value="Glosa"/>
    </MudItem>
</MudGrid>

<MudStack Row="true" Class="mt-3" Style="align-self: end">
    <MudTooltip Text="Agregar comprobante" Placement="Placement.Bottom">
        <MudFab Color="Color.Success"
                IconSize="Size.Medium"
                StartIcon="@Icons.Material.Filled.PostAdd"
                Size="Size.Small"
                DisableElevation="true"
                OnClick="@AgregarComprobante"/>
    </MudTooltip>
    <MudTooltip Text="Agregar detalle" Placement="Placement.Bottom">
        <MudFab Color="Color.Info"
                IconSize="Size.Medium"
                StartIcon="@Icons.Material.Filled.NoteAdd"
                Size="Size.Small"
                DisableElevation="true"
                OnClick="OpenAgregarDetalleModal"/>
    </MudTooltip>
</MudStack>

<style>
    .right-aligned-input input {
        text-align: right;
    }
    .modal-background{
        background: rgba(0,0,0,0.5);
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
    }
</style>